---
// Writing/Blog section
import { getCollection } from 'astro:content';

// Get all posts and sort by date (most recent first)
const allPosts = await getCollection('posts');
const sortedPosts = allPosts.sort((a, b) => {
  return new Date(b.data.datePublished).getTime() - new Date(a.data.datePublished).getTime();
});

// Get the 3 most recent posts
const articles = sortedPosts.slice(0, 3).map(post => ({
  title: post.data.name,
  excerpt: post.data.postDescription,
  date: new Date(post.data.datePublished).toLocaleDateString('es-ES', { 
    year: 'numeric', 
    month: 'short', 
    day: 'numeric' 
  }),
  slug: post.slug
}));
---

<section id="writing" class="py-24 border-t border-white/5">
  <div class="max-w-6xl mx-auto px-6">
    <div class="flex items-center justify-between mb-12">
      <h2 class="text-3xl md:text-4xl font-medium text-white tracking-tight">Escritos</h2>
      <a href="/blog" class="text-sm text-neutral-500 hover:text-white transition-colors">
        Todos los Art√≠culos
      </a>
    </div>

    <div class="flex flex-col">
      {articles.map((article) => (
        <article class="group relative py-6 border-b border-white/5 hover:bg-white/[0.02] transition-colors -mx-4 px-4 rounded-lg cursor-pointer">
          <a href={`/blog/${article.slug}`} class="block">
            <div class="flex flex-col md:flex-row md:items-baseline md:justify-between gap-2">
              <div class="flex flex-col gap-1">
                <h3 class="text-lg font-medium text-neutral-200 group-hover:text-white transition-colors">
                  {article.title}
                </h3>
                <p class="text-sm text-neutral-500 line-clamp-1 max-w-xl">
                  {article.excerpt}
                </p>
              </div>
              <div class="flex items-center gap-4 text-xs font-mono text-neutral-500 shrink-0">
                <span>{article.date}</span>
                <span class="hidden md:inline-block opacity-0 group-hover:opacity-100 transition-opacity transform group-hover:translate-x-1 duration-300">
                  <span class="iconify" data-icon="lucide:arrow-right" data-width="16"></span>
                </span>
              </div>
            </div>
          </a>
        </article>
      ))}
    </div>
  </div>
</section>
